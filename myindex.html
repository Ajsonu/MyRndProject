

<!DOCTYPE html>
<html>
<head>
  <title>Face Verification</title>
  <script src="https://web-sdk.prod.cdn.spain.ozforensics.com/blsinternational/plugin_liveness.php"></script>
  <script>
    window.addEventListener('load', async function () {
      // Step 1: Request camera permissions first
      try {
        const stream = await navigator.mediaDevices.getUserMedia({ video: true });
        stream.getTracks().forEach(track => track.stop()); // Close camera (OzLiveness will reopen it)
        
        // Step 2: Initialize OzLiveness after permissions are granted
        OzLiveness.open({
          lang: 'en',
          meta: {
            'user_id': new URLSearchParams(window.location.search).get('user_id'),
            'transaction_id': new URLSearchParams(window.location.search).get('transaction_id')
          },
          action: ['video_selfie_blank'],
          on_complete: function (result) {
            window.location.href = `https://yourbackend.com/callback?session_id=${result.event_session_id}`;
          }
        });
      } catch (error) {
        alert("Camera access denied. Please allow permissions to proceed.");
        console.error("Camera error:", error);
        console.log("Error:",error);
      }
    });
  </script>
</head>
<body>
  <p>Loading face verification...</p>
</body>
</html>
